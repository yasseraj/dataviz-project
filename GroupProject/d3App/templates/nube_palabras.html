{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Data visualization</title>
    <!-- HTML5 Shim and Respond.js IE10 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 10]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="{% static 'js/d3.layout.cloud.js' %}"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="Gradient Able Bootstrap admin template made using Bootstrap 4 and it has huge amount of ready made feature, UI components, pages which completely fulfills any dashboard needs." />
    <meta name="keywords" content="flat ui, admin Admin , Responsive, Landing, Bootstrap, App, Template, Mobile, iOS, Android, apple, creative app">
    <meta name="author" content="Phoenixcoded" />
    <!-- Favicon icon -->
    <link rel="icon" href="{% static 'files/assets/images/favicon.ico' %}" type="image/x-icon">
    <!-- Google font-->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet">
    <!-- Required Fremwork -->
    <link rel="stylesheet" type="text/css" href="{% static 'files/bower_components/bootstrap/css/bootstrap.min.css' %}">
    <!-- waves.css -->
    <link rel="stylesheet" href="{% static 'files/assets/pages/waves/css/waves.min.css' %}" type="text/css" media="all">
    <!-- feather icon -->
    <link rel="stylesheet" type="text/css" href="{% static 'files/assets/icon/feather/css/feather.css' %}">
    <!-- Style.css -->
    <link rel="stylesheet" type="text/css" href="{% static 'files/assets/css/style.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'files/assets/css/widget.css' %}">
    <style>
        .main-menu .main-menu-header img {
            position: relative;
            width: 200px;
            margin: 0 auto 15px;
            display: block;
            border-radius: 0;
        }
        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
        }

        .x.axis path {
            display: none;
        }

        .line {
            fill: none;
            stroke: steelblue;
            stroke-width: 1.5px;
        }
    </style>
</head>

<body>
<!-- [ Pre-loader ] start -->
<div class="loader-bg">
    <div class="loader-bar"></div>
</div>
<!-- [ Pre-loader ] end -->
<div id="pcoded" class="pcoded">
    <div class="pcoded-overlay-box"></div>
    <div class="pcoded-container navbar-wrapper">

        <div class="pcoded-main-container">
            <div class="pcoded-wrapper">
                <!-- [ navigation menu ] start -->
                <nav class="pcoded-navbar">
                    <div class="pcoded-inner-navbar main-menu">
                        <div class="">
                            <div class="main-menu-header">
                                <img class="img-menu-user img-radius" src="{% static 'files/assets/images/logo.png' %}" alt="User-Profile-Image">
                            </div>
                        </div>
                        <ul class="pcoded-item pcoded-left-item">
                            <li class="pcoded-hasmenu">
                                <a href="javascript:void(0)" class="waves-effect waves-dark">
                                    <span class="pcoded-micon"><i class="feather icon-home"></i></span>
                                    <span class="pcoded-mtext">Dashboard</span>
                                </a>
                                <ul class="pcoded-submenu">
                                    <li class="">
                                        <a href="{% url 'home' %}" class="waves-effect waves-dark">
                                            <span class="pcoded-mtext">Datasets</span>
                                        </a>
                                    </li>
                                    <li class="">
                                        <a href="{% url 'following_er' %}" class="waves-effect waves-dark">
                                            <span class="pcoded-mtext">Barras</span>
                                        </a>
                                    </li>
                                    <li class="">
                                        <a href="{% url 'lineas' %}" class="waves-effect waves-dark">
                                            <span class="pcoded-mtext">LÃ­neas</span>
                                        </a>
                                    </li>
                                    <li class="active">
                                        <a href="{% url 'pagina_nube_palabras' %}" class="waves-effect waves-dark">
                                            <span class="pcoded-mtext">Nube de palabras</span>
                                        </a>
                                    </li>
                                    <li class="">
                                        <a href="{% url 'burbuja' %}" class="waves-effect waves-dark">
                                            <span class="pcoded-mtext">Burbujas</span>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </nav>
                <!-- [ navigation menu ] end -->
                <div class="pcoded-content">
                    <!-- [ breadcrumb ] start -->
                    <div class="page-header">
                        <div class="page-block">
                            <div class="row align-items-center">
                                <div class="col-md-8">
                                    <div class="page-header-title">
                                        <h4 class="m-b-10">Dashboard</h4>
                                    </div>
                                    <ul class="breadcrumb">
                                        <li class="breadcrumb-item">
                                            <a href="home.html">
                                                <i class="feather icon-home"></i>
                                            </a>
                                        </li>
                                        <li class="breadcrumb-item">
                                            <a href="#!">Nube de Palabras</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- [ breadcrumb ] end -->
                    <div class="pcoded-inner-content">
                        <div class="main-body">
                            <div class="page-wrapper">
                                <div class="page-body">
                                    <!-- [ page content ] start -->
                                    <div class="row">

                                        <!-- site Analytics card start -->
                                        <div class="col-lg-12 col-md-12">
                                            <div class="card">
                                                <div class="card-header borderless">
                                                    <h5>Nube de palabras</h5>
                                                    <span class="text-muted"></span>
                                                    <div class="card-header-right">
                                                        <ul class="list-unstyled card-option">
                                                            <li class="first-opt"><i class="feather icon-chevron-left open-card-option"></i></li>
                                                            <li><i class="feather icon-maximize full-card"></i></li>
                                                            <li><i class="feather icon-minus minimize-card"></i></li>
                                                            <li><i class="feather icon-refresh-cw reload-card"></i></li>
                                                            <li><i class="feather icon-chevron-left open-card-option"></i></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div id="grafica" style="text-align: center!important;" class="card-block">

                                                </div>
                                            </div>
                                        </div>
                                        <!-- site Analytics card end -->

                                    </div>
                                    <!-- [ page content ] end -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Warning Section Starts -->
<!-- Older IE warning message -->
<!--[if lt IE 10]>
    <div class="ie-warning">
        <h1>Warning!!</h1>
        <p>You are using an outdated version of Internet Explorer, please upgrade
            <br/>to any of the following web browsers to access this website.
        </p>
        <div class="iew-container">
            <ul class="iew-download">
                <li>
                    <a href="http://www.google.com/chrome/">
                        <img src="../files/assets/images/browser/chrome.png" alt="Chrome">
                        <div>Chrome</div>
                    </a>
                </li>
                <li>
                    <a href="https://www.mozilla.org/en-US/firefox/new/">
                        <img src="../files/assets/images/browser/firefox.png" alt="Firefox">
                        <div>Firefox</div>
                    </a>
                </li>
                <li>
                    <a href="http://www.opera.com">
                        <img src="../files/assets/images/browser/opera.png" alt="Opera">
                        <div>Opera</div>
                    </a>
                </li>
                <li>
                    <a href="https://www.apple.com/safari/">
                        <img src="../files/assets/images/browser/safari.png" alt="Safari">
                        <div>Safari</div>
                    </a>
                </li>
                <li>
                    <a href="http://windows.microsoft.com/en-us/internet-explorer/download-ie">
                        <img src="../files/assets/images/browser/ie.png" alt="">
                        <div>IE (9 & above)</div>
                    </a>
                </li>
            </ul>
        </div>
        <p>Sorry for the inconvenience!</p>
    </div>
<![endif]-->
<!-- Warning Section Ends -->
<!-- Required Jquery -->
<!-- Required Jquery -->
<script type="text/javascript" src="{% static 'files/bower_components/jquery/js/jquery.min.js' %}"></script>
<script type="text/javascript" src="{% static 'files/bower_components/jquery-ui/js/jquery-ui.min.js' %}"></script>
<script type="text/javascript" src="{% static 'files/bower_components/popper.js/js/popper.min.js' %}"></script>
<script type="text/javascript" src="{% static 'files/bower_components/bootstrap/js/bootstrap.min.js' %}"></script>
<!-- waves js -->
<script src="{% static 'files/assets/pages/waves/js/waves.min.js' %}"></script>
<!-- jquery slimscroll js -->
<script type="text/javascript" src="{% static 'files/bower_components/jquery-slimscroll/js/jquery.slimscroll.js' %}"></script>
<!-- Float Chart js -->
<script src="{% static 'files/assets/pages/chart/float/jquery.flot.js' %}"></script>
<script src="{% static 'files/assets/pages/chart/float/jquery.flot.categories.js' %}"></script>
<script src="{% static 'files/assets/pages/chart/float/curvedLines.js' %}"></script>
<script src="{% static 'files/assets/pages/chart/float/jquery.flot.tooltip.min.js' %}"></script>
<!-- amchart js -->
<script src="{% static 'files/assets/pages/widget/amchart/amcharts.js' %}"></script>
<script src="{% static 'files/assets/pages/widget/amchart/serial.js' %}"></script>
<script src="{% static 'files/assets/pages/widget/amchart/light.js' %}"></script>
<!-- Custom js -->
<script src="{% static 'files/assets/js/pcoded.min.js' %}"></script>
<script src="{% static 'files/assets/js/vertical/vertical-layout.min.js' %}"></script>
<script type="text/javascript" src="{% static 'files/assets/pages/dashboard/custom-dashboard.min.js' %}"></script>
<script type="text/javascript" src="{% static 'files/assets/js/script.min.js' %}"></script>
<script>
    var words = [];
    var size = [700,400];
    var length = 95;

    var colors_list = [];
    for(var i=0; i<length;i++){
        var c = "#"+((1<<24)*Math.random()|0).toString(16);
        colors_list.push(c);
    }
    var blackWords= [
        "@",
        ",",
        ".",
        "?",
        "??",
        "???",
        "????",
        "?????"
    ];

    d3.json("{% url "nube_palabras" %}", function(error, data) {
        datasetPalabras = data;
        datasetPalabras.forEach(function(element){
            var text = element.keyword;
            if(! blackWords.includes(text)){
                var size = parseInt(element.repeats*100/9721);
                var elementAux = {text,size};
                words.push(elementAux);
            }
        });
        words = words.slice(0,90);
        d3.layout.cloud().size([size[0],size[1]])
            .words(words)
            .rotate(0)
            .fontSize(function(d) { return d.size; })
            .on("end", draw)
            .start();
    });

    function draw(words) {
        d3.select("#grafica").append("svg")
            .attr("width", size[0])
            .attr("height", size[1])
            .attr("class", "wordcloud")
            .append("g")
            .attr("transform", "translate(320,200)")
            .selectAll("text")
            .data(words)
            .enter().append("text")
            .style("font-size", function(d) { return d.size + "px"; })
            .style("fill", function(d,i) {
                return colors_list[i];
            })
            .attr("transform", function(d) {
                return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
            })
            .text(function(d) {
                return d.text;
            });
    }
</script>

</body>

</html>
